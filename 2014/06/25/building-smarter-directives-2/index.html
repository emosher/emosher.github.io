<!DOCTYPE html><html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>emosher</title><link rel="stylesheet" href="/css/pure-min.css">
<link rel="stylesheet" href="/css/grids-responsive-min.css">
<link rel="stylesheet" href="/css/style.css"></head><body><div id="layout" class="pure-g"><div class="sidebar pure-u-1 pure-u-md-1-4"><div class="header"><h1 class="brand-title"><a href="/">emosher</a></h1><h2 class="brand-tagline">Geek, coder/developer, musician, gamer.</h2><nav class="nav"><ul class="nav-list"><li class="nav-item"><a href="/archives" class="pure-button">archives</a></li><li class="nav-item"><a href="/about" class="pure-button">about</a></li></ul></nav></div></div><div class="content pure-u-1 pure-u-md-3-4"><div class="posts"><div class="post"><div class="post-header"><h2 class="post-title">Building Smarter Directives #2</h2><p class="post-meta"><span class="post-date"><i class="icon-clock"></i>2014-06-25 22:29</span><span class="post-tags"><i class="icon-tags"></i><a href="/tags/angularjs-javascript-directives/" class="post-tag">
- angularjs
- javascript
- directives</a></span></p></div><div class="post-content"><p>My <a href="https://emosher.org/2014/05/19/building-smarter-directives/" target="_blank" rel="external">last post</a> talked about conditionally loading templates using <code>ng-include</code>. </p>
<p>I spent a good amount of time using this, but found it to be problematic because it was causing my HTML to become bloated. Instead of adding to the div soup, I set out to find a better way.</p>
<p>This leads to nested divs:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div ng-include=&quot;contentUrl&quot;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure></p>
<p>Renders something like this:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div ng-include=&quot;contentUrl&quot;&gt;</span><br><span class="line">    &lt;div&gt; This is the template &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure></p>
<p>As it turned out, there are options! First, I found out that in 1.1.4, Angular added the ability to use a function as the <code>templateUrl</code>. In your directive definition object, you can have the following:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">angular.module(<span class="string">'myApp'</span>, [])</span><br><span class="line">    .directive(<span class="string">'example'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    	<span class="keyword">return</span> &#123;</span><br><span class="line">        	templateUrl: <span class="function"><span class="keyword">function</span>(<span class="params">tElement, tAttrs</span>) </span>&#123;</span><br><span class="line">                <span class="comment">// Template can be chosen here</span></span><br><span class="line">                <span class="comment">// Try something like this</span></span><br><span class="line">                <span class="keyword">return</span> tAttrs.example.toLowerCase() + <span class="string">'.html'</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">	&#125;);</span><br></pre></td></tr></table></figure>
<p>Then use it like this: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Includes &apos;one.html&apos; --&gt;</span><br><span class="line">&lt;div example=&quot;one&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;!-- Includes &apos;two.html&apos; --&gt;</span><br><span class="line">&lt;div example=&quot;two&quot;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>The other option that I found was to do what is essentially a manual <code>ng-include</code>. The problem I’ve found with this is that it makes the directive a bit harder to test. By going around Angular’s built in ways of including the template, you are circumventing the  <code>$templateCache</code>.</p>
<p>To do this, you use the <code>$http</code> and <code>$compile</code> service to retrieve and compile the template yourself:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">angular.module(<span class="string">'myApp'</span>)</span><br><span class="line">    .directive(<span class="string">'example'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$http, $compile</span>) </span>&#123;</span><br><span class="line">    	<span class="keyword">return</span> &#123;</span><br><span class="line">        	link: <span class="function"><span class="keyword">function</span>(<span class="params">scope, element, attrs</span>) </span>&#123;</span><br><span class="line">        		$http.get(attrs.example + <span class="string">'.html'</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</span><br><span class="line">                	element.html($compile(response.data)(scope));</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<p>This version of the directive would be used the same as above, allowing you to include <code>one.html</code> or <code>two.html</code>.</p>
<p>Whatever you decide to use, the good news is that you have options to suit your situation.</p>
</div><nav id="post-nav"><a id="post-nav-newer" href="/2014/08/18/ghost-0-5/" class="post-nav-link-wrap"><strong class="post-nav-caption">Newer</strong><div class="post-nav-title">Ghost 0.5</div></a><a id="post-nav-older" href="/2014/05/15/building-smarter-directives/" class="post-nav-link-wrap"><strong class="post-nav-caption">Older</strong><div class="post-nav-title">Building Smarter Directives</div></a></nav></div></div><div class="footer"><div class="social-link"><a href="http://weibo.com/" target="_blank"><i class="icon-weibo"></i></a><a href="https://github.com/emosher" target="_blank"><i class="icon-github"></i></a><a href="https://plus.google.com/" target="_blank"><i class="icon-gplus"></i></a><a href="https://twitter.com/emoshmosh" target="_blank"><i class="icon-twitter"></i></a></div><div class="copyright">&copy; 2016 Eric Mosher.
Powered by <a href="http://hexo.io" target="_blank">Hexo</a>
using <a href="https://github.com/saintwinkle/hexo-theme-pure" target="_blank">Pure</a> theme.</div></div></div><script src="/js/script.js"></script></div></body></html>